replicaCount: 2

namespace: suma-chat

image:
  repository: suma-chat
  tag: latest
  pullPolicy: IfNotPresent

nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: true
  annotations: {}
  name: ""

podAnnotations: {}

resources:
  requests:
    cpu: 100m
    memory: 256Mi
  limits:
    cpu: 500m
    memory: 512Mi

# Application Configuration
config:
  port: 4000
  nodeEnv: production
  timezone: "Asia/Jakarta"
  apiUrl: "http://suma-ecommerce"
  socketPath: "/socket.io"

# Redis Configuration
redis:
  enabled: true
  image:
    repository: redis
    tag: alpine
  persistence:
    enabled: true
    size: 8Gi
  service:
    type: ClusterIP
    port: 6379

# Network Policy
networkPolicy:
  enabled: true
  allowedNamespaces:
    - ingress-nginx
    - nginx-system

# Service
service:
  type: ClusterIP
  port: 80

# Ingress
ingress:
  enabled: true
  className: nginx
  hosts:
    - name: local
      host: suma-chat.local
      tls: true
      tlsSecret: suma-chat-tls
      annotations:
        kubernetes.io/ingress.class: "nginx"
      paths:
        - path: /
          pathType: Prefix
    - name: api
      host: api.suma-honda.id
      tls: true
      tlsSecret: api-suma-honda-id-tls
      annotations:
        kubernetes.io/ingress.class: "nginx"
        nginx.ingress.kubernetes.io/use-regex: "true"
        nginx.ingress.kubernetes.io/rewrite-target: "/$2"
        nginx.ingress.kubernetes.io/proxy-body-size: "10m"
        nginx.ingress.kubernetes.io/proxy-read-timeout: "3600"
        nginx.ingress.kubernetes.io/proxy-send-timeout: "3600"
        nginx.ingress.kubernetes.io/proxy-http-version: "1.1"
        nginx.ingress.kubernetes.io/proxy-buffering: "off"
      paths:
        - path: /chat(/|$)(.*)
          pathType: ImplementationSpecific

# Pod Disruption Budget
podDisruptionBudget:
  enabled: true
  minAvailable: 1

# Horizontal Pod Autoscaler
autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 4
  targetCPUUtilizationPercentage: 50
  targetMemoryUtilizationPercentage: 50

certificate:
  enabled: true
  certificates:
    - name: suma-chat-local-tls
      secretName: suma-chat-tls
      issuerRef:
        name: selfsigned-cluster-issuer
        kind: ClusterIssuer
      dnsNames:
        - suma-chat.local